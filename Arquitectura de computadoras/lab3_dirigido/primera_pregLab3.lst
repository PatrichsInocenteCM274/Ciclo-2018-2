
ASEM-51 V1.3                                         Copyright (c) 2002 by W.W. Heinz                                         PAGE 1





       MCS-51 Family Macro Assembler   A S E M - 5 1   V 1.3
       =====================================================



	Source File:	C:\Software_CC212_arquitectura\lab3_dirigido\primera_pregLab3.asm
	Object File:	C:\Software_CC212_arquitectura\lab3_dirigido\primera_pregLab3.hex
	List File:	C:\Software_CC212_arquitectura\lab3_dirigido\primera_pregLab3.lst



 Line  I  Addr  Code            Source

    1:				;Hacer un programa para el TMC51 para seleccionar una frecuencia de
    2:				;2hz, 12hz, 22hz y 32h de tal manera que enviando un “01” por el
    3:				;puerto serie seleccione una frecuencia de 2
    4:				;hertz, enviando un “02” seleccione 12 hertz,
    5:				;enviando “03” seleccione 22 hertz y
    6:				;enviando “04” seleccione 32 hertz. La señal saldrá por el pin P1.0
    7:				;del Puerto 1.Sugerencia: Usar el timer 0 en modo 0.
    8:
    9:		N      010C	break     equ  010ch  ; a, (lee acumulador)
   10:		N      012A	inkey     equ  012ah  ; a
   11:		N      0115	crlf      equ  115h
   12:		N      02F0	endloop   equ  2f0h
   13:		N      0136	print     equ  136h
   14:		N      011E	getbyt    equ  11eh
   15:		N      8000	          org       8000h    ;El programa empieza en esta direcci¢n de
   16:				                             ;de memoria
   17:	  8000			ejemplo:
   18:	  8000	12 01 36	          lcall     print   ;PRINT es una subrutina grabado en el FlashRom
   19:				                            ;se usa para imprimir mensajes en el terminal de la PC.
   20:	  8003	0D 0A 20 4D	          db        0dh,0ah," M E N U "
	  8007	20 45 20 4E
	  800B	20 55 20
   21:	  800E	0D 0A 3D 3D	          db        0dh,0ah,"=========",0dh,0ah
	  8012	3D 3D 3D 3D
	  8016	3D 3D 3D 0D
	  801A	0A
   22:	  801B	0D 0A 20 48	          db        0dh,0ah," HECHO POR: C. Martin Cruz Salazar",0dh,0ah
	  801F	45 43 48 4F
	  8023	20 50 4F 52
	  8027	3A 20 43 2E
	  802B	20 4D 61 72
	  802F	74 69 6E 20
	  8033	43 72 75 7A
	  8037	20 53 61 6C
	  803B	61 7A 61 72
	  803F	0D 0A
   23:	  8041	0D 0A 20 30	          db        0dh,0ah," 01) FRECUENCIA: 2 HZ"
	  8045	31 29 20 46
	  8049	52 45 43 55
	  804D	45 4E 43 49
	  8051	41 3A 20 32
	  8055	20 48 5A
   24:	  8058	0D 0A 20 30	          db        0dh,0ah," 02) FRECUENCIA: 12 HZ"

ASEM-51 V1.3                                         Copyright (c) 2002 by W.W. Heinz                                         PAGE 2



 Line  I  Addr  Code            Source

	  805C	32 29 20 46
	  8060	52 45 43 55
	  8064	45 4E 43 49
	  8068	41 3A 20 31
	  806C	32 20 48 5A
   25:	  8070	0D 0A 20 30	          db        0dh,0ah," 03) FRECUENCIA: 22 HZ",0dh,0ah
	  8074	33 29 20 46
	  8078	52 45 43 55
	  807C	45 4E 43 49
	  8080	41 3A 20 32
	  8084	32 20 48 5A
	  8088	0D 0A
   26:	  808A	0D 0A 20 53	          db        0dh,0ah," Seleccione numero hexadecimal: ",0
	  808E	65 6C 65 63
	  8092	63 69 6F 6E
	  8096	65 20 6E 75
	  809A	6D 65 72 6F
	  809E	20 68 65 78
	  80A2	61 64 65 63
	  80A6	69 6D 61 6C
	  80AA	3A 20 00
   27:	  80AD	12 01 1E	          lcall     getbyt
   28:	  80B0	B4 01 02	          cjne      a,#1h,salir
   29:	  80B3	80 02		          sjmp      frec2hz
   30:	  80B5			salir:
   31:	  80B5	80 5C		          sjmp      otrafrecuencia
   32:
   33:	  80B7			frec2hz:
   34:	  80B7	12 01 36		  lcall     print
   35:	  80BA	0D 0A 46 52	          db       0dh,0ah,"FRECUENCIA SELECCIONADA: 2Hz"
	  80BE	45 43 55 45
	  80C2	4E 43 49 41
	  80C6	20 53 45 4C
	  80CA	45 43 43 49
	  80CE	4F 4E 41 44
	  80D2	41 3A 20 32
	  80D6	48 7A
   36:	  80D8	0D 0A 3D 3D	          db       0dh,0ah,"==============================",0dh,0ah,0h
	  80DC	3D 3D 3D 3D
	  80E0	3D 3D 3D 3D
	  80E4	3D 3D 3D 3D
	  80E8	3D 3D 3D 3D
	  80EC	3D 3D 3D 3D
	  80F0	3D 3D 3D 3D
	  80F4	3D 3D 3D 3D
	  80F8	0D 0A 00
   37:	  80FB	75 89 20	          mov TMOD,#20h		;configura el timer 0 en modo 0
   38:								; como un temporizador de 13 bits
   39:	  80FE	75 8C 00		  mov TH0,#0
   40:	  8101	75 8A 00		  mov TL0,#0		;
   41:	  8104	D2 8C			  setb TR0		;inicia el timer 0
   42:	  8106	7F 1C			  mov R7,#28		;contador
   43:	  8108			loop:
   44:	  8108	12 81 DC		  lcall f2hz
   45:	  810B	12 01 2A		  lcall inkey         ;
   46:	  810E	12 01 0C	 	  lcall break         ; termina programa si CTL-C

ASEM-51 V1.3                                         Copyright (c) 2002 by W.W. Heinz                                         PAGE 3



 Line  I  Addr  Code            Source

   47:	  8111	80 F5			  sjmp loop
   48:
   49:	  8113			otrafrecuencia:
   50:	  8113	B4 02 02		cjne      a,#2h,salir1
   51:	  8116	80 02		  	sjmp      frec12hz
   52:	  8118			salir1:
   53:	  8118	80 5D			sjmp otrafrecuencia1
   54:	  811A			frec12hz:
   55:	  811A	12 01 36		lcall     print
   56:	  811D	0D 0A 46 52	          db       0dh,0ah,"FRECUENCIA SELECCIONADA: 12Hz"
	  8121	45 43 55 45
	  8125	4E 43 49 41
	  8129	20 53 45 4C
	  812D	45 43 43 49
	  8131	4F 4E 41 44
	  8135	41 3A 20 31
	  8139	32 48 7A
   57:	  813C	0D 0A 3D 3D	          db       0dh,0ah,"==============================",0dh,0ah,0h
	  8140	3D 3D 3D 3D
	  8144	3D 3D 3D 3D
	  8148	3D 3D 3D 3D
	  814C	3D 3D 3D 3D
	  8150	3D 3D 3D 3D
	  8154	3D 3D 3D 3D
	  8158	3D 3D 3D 3D
	  815C	0D 0A 00
   58:	  815F	75 89 20		mov TMOD,#20h	;configura el timer 0 en modo 0
   59:							;como un temporizador de 13 bits
   60:	  8162	75 8C 00		mov TH0,#0
   61:	  8165	75 8A 00		mov TL0,#0
   62:	  8168	D2 8C			setb TR0	;inicia el timer 0
   63:	  816A	7F 05			mov R7,#5	;contador
   64:	  816C			loop1:
   65:	  816C	12 81 E8		lcall f12hz
   66:	  816F	12 01 2A		lcall inkey         ;
   67:	  8172	12 01 0C	 	lcall break         ; termina programa si CTL-C
   68:	  8175	80 F5			sjmp loop1
   69:	  8177			otrafrecuencia1:
   70:	  8177	B4 03 02		cjne      a,#3h,salir2
   71:	  817A	80 03		  	sjmp      frec22hz
   72:	  817C			salir2:
   73:	  817C	02 02 F0		ljmp 2F0h
   74:	  817F			frec22hz:
   75:	  817F	12 01 36		lcall     print
   76:	  8182	0D 0A 46 52	          db       0dh,0ah,"FRECUENCIA SELECCIONADA: 22Hz"
	  8186	45 43 55 45
	  818A	4E 43 49 41
	  818E	20 53 45 4C
	  8192	45 43 43 49
	  8196	4F 4E 41 44
	  819A	41 3A 20 32
	  819E	32 48 7A
   77:	  81A1	0D 0A 3D 3D	          db       0dh,0ah,"==============================",0dh,0ah,0h
	  81A5	3D 3D 3D 3D
	  81A9	3D 3D 3D 3D
	  81AD	3D 3D 3D 3D

ASEM-51 V1.3                                         Copyright (c) 2002 by W.W. Heinz                                         PAGE 4



 Line  I  Addr  Code            Source

	  81B1	3D 3D 3D 3D
	  81B5	3D 3D 3D 3D
	  81B9	3D 3D 3D 3D
	  81BD	3D 3D 3D 3D
	  81C1	0D 0A 00
   78:	  81C4	75 89 20		mov TMOD,#20h		;configura el timer 0 en modo 0
   79:								; como un temporizador de 13 bits
   80:	  81C7	75 8C 00		mov TH0,#0
   81:	  81CA	75 8A 00		mov TL0,#0
   82:	  81CD	D2 8C			setb TR0		;inicia el timer 0
   83:	  81CF	7F 03			mov R7,#3		;contador
   84:	  81D1			loop2:
   85:	  81D1	12 81 F4		lcall f22hz
   86:	  81D4	12 01 2A		lcall inkey         ;
   87:	  81D7	12 01 0C	 	lcall break         ; termina programa si CTL-C
   88:	  81DA	80 F5			sjmp loop2
   89:
   90:
   91:	  81DC			f2hz:
   92:	  81DC	30 8D FD		jnb TF0,$	;esto se repite mientras TF0 es cero y no hay
   93:							;desbordamiento
   94:
   95:	  81DF	C2 8D			clr TF0		;este flag de desbordamiento se pone a 1 por hardware,
   96:							;este flag debe ser puesto a 0 por software
   97:	  81E1	DF F9			djnz R7,f2hz
   98:	  81E3	7F 1C			mov R7,#28
   99:	  81E5	B2 90			cpl P1.0
  100:	  81E7	22			ret
  101:	  81E8			f12hz:
  102:	  81E8	30 8D FD		jnb TF0,$	;esto se repite mientras TF0 es cero y no hay
  103:							;desbordamiento
  104:	  81EB	C2 8D			clr TF0		;este flag de desbordamiento se pone a 1 por hardware,
  105:							;este flag debe ser puesto a 0 por software
  106:	  81ED	DF F9			djnz R7,f12hz	;
  107:	  81EF	7F 05			mov R7,#5
  108:	  81F1	B2 90			cpl P1.0
  109:	  81F3	22			ret
  110:
  111:	  81F4			f22hz:
  112:	  81F4	30 8D FD		jnb TF0,$	;esto se repite mientras TF0 es cero y no hay
  113:	  81F7	C2 8D			clr TF0		;este flag de desbordamiento se pone a 1 por hardware,
  114:							;este flag debe ser puesto a 0 por software
  115:	  81F9	DF F9			djnz R7,f22hz	;
  116:	  81FB	7F 03			mov R7,#3
  117:	  81FD	B2 90			cpl P1.0
  118:	  81FF	C2 8D			clr TF0
  119:	  8201	22			ret
  120:					end
  121:





                     register banks used:  ---


ASEM-51 V1.3                                         Copyright (c) 2002 by W.W. Heinz                                         PAGE 5



                     no errors




ASEM-51 V1.3                                         Copyright (c) 2002 by W.W. Heinz                                         PAGE 6





	       L I S T   O F   S Y M B O L S
	       =============================


SYMBOL				  TYPE     VALUE	LINE
------------------------------------------------------------
??ASEM_51			  NUMBER    8051
??VERSION			  NUMBER    0130
AC				  BIT	      D6
ACC				  DATA	      E0
B				  DATA	      F0
BREAK				  NUMBER    010C	   9
CRLF				  NUMBER    0115	  11
CY				  BIT	      D7
DPH				  DATA	      83
DPL				  DATA	      82
EA				  BIT	      AF
EJEMPLO				  CODE	    8000	  17
ENDLOOP				  NUMBER    02F0	  12
ES				  BIT	      AC
ET0				  BIT	      A9
ET1				  BIT	      AB
EX0				  BIT	      A8
EX1				  BIT	      AA
EXTI0				  CODE	    0003
EXTI1				  CODE	    0013
F0				  BIT	      D5
F12HZ				  CODE	    81E8	 101
F22HZ				  CODE	    81F4	 111
F2HZ				  CODE	    81DC	  91
FREC12HZ			  CODE	    811A	  54
FREC22HZ			  CODE	    817F	  74
FREC2HZ				  CODE	    80B7	  33
GETBYT				  NUMBER    011E	  14
IE				  DATA	      A8
IE0				  BIT	      89
IE1				  BIT	      8B
INKEY				  NUMBER    012A	  10
INT0				  BIT	      B2
INT1				  BIT	      B3
IP				  DATA	      B8
IT0				  BIT	      88
IT1				  BIT	      8A
LOOP				  CODE	    8108	  43
LOOP1				  CODE	    816C	  64
LOOP2				  CODE	    81D1	  84
OTRAFRECUENCIA			  CODE	    8113	  49
OTRAFRECUENCIA1			  CODE	    8177	  69
OV				  BIT	      D2
P				  BIT	      D0
P0				  DATA	      80
P1				  DATA	      90
P2				  DATA	      A0
P3				  DATA	      B0
PCON				  DATA	      87
PRINT				  NUMBER    0136	  13

ASEM-51 V1.3                                         Copyright (c) 2002 by W.W. Heinz                                         PAGE 7



SYMBOL				  TYPE     VALUE	LINE
------------------------------------------------------------
PS				  BIT	      BC
PSW				  DATA	      D0
PT0				  BIT	      B9
PT1				  BIT	      BB
PX0				  BIT	      B8
PX1				  BIT	      BA
RB8				  BIT	      9A
RD				  BIT	      B7
REN				  BIT	      9C
RESET				  CODE	    0000
RI				  BIT	      98
RS0				  BIT	      D3
RS1				  BIT	      D4
RXD				  BIT	      B0
SALIR				  CODE	    80B5	  30
SALIR1				  CODE	    8118	  52
SALIR2				  CODE	    817C	  72
SBUF				  DATA	      99
SCON				  DATA	      98
SINT				  CODE	    0023
SM0				  BIT	      9F
SM1				  BIT	      9E
SM2				  BIT	      9D
SP				  DATA	      81
T0				  BIT	      B4
T1				  BIT	      B5
TB8				  BIT	      9B
TCON				  DATA	      88
TF0				  BIT	      8D
TF1				  BIT	      8F
TH0				  DATA	      8C
TH1				  DATA	      8D
TI				  BIT	      99
TIMER0				  CODE	    000B
TIMER1				  CODE	    001B
TL0				  DATA	      8A
TL1				  DATA	      8B
TMOD				  DATA	      89
TR0				  BIT	      8C
TR1				  BIT	      8E
TXD				  BIT	      B1
WR				  BIT	      B6
